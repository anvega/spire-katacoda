Get latest SPIRE release tar:
 `wget https://github.com/spiffe/spire/releases/download/0.9.1/spire-0.9.1-linux-x86_64-glibc.tar.gz`{{execute HOST2}}

Extract the tar:
`tar -xvf spire-0.9.1-linux-x86_64-glibc.tar.gz`{{execute HOST2}}

Look at the agent configuration file:
` cat agent.conf`{{execute HOST2}}

Set `trust_domain` to [[HOST_SUBDOMAIN]]-80-[[KATACODA_HOST]].environments.katacoda.com in agent.conf
`sed -i 's/<TRUST_DOMAIN>/[[HOST_SUBDOMAIN]]-80-[[KATACODA_HOST]].environments.katacoda.com/g' agent.conf`{{execute HOST2}}

Set `server_address` to [[HOST_SUBDOMAIN]]-8081-[[KATACODA_HOST]].environments.katacoda.com in agent.conf
`sed -i 's/<SPIRE_SERVER>/[[HOST_SUBDOMAIN]]-8081-[[KATACODA_HOST]].environments.katacoda.com/g' agent.conf`{{execute HOST2}}

Join Token Node Attestation:
The join_token plugin attests a node based on a pre-shared, one-time-use join token. A token must be generated by the server before it can be used to attest a node.
Tokens may be generated through the CLI utility (spire-server token generate).
Generate Join Token by running the command below on the SPIRE Server: 
`./spire-0.9.1/bin/spire-server token generate -spiffeID spiffe://[[HOST_SUBDOMAIN]]-80-[[KATACODA_HOST]].environments.katacoda.com/clientnode`{{execute HOST1}}

Start the SPIRE Agent using the generated join token:
The join_token is responsible for attesting the agent's identity using a one-time-use pre-shared key.
The join token itself is configured by a CLI flag (-joinToken).
Run the command below on Host 2 Terminal replacing the <JOIN_TOKEN> placeholder with the token generated earlier
`./spire-0.9.1/bin/spire-agent run -config agent.conf -joinToken <JOIN_TOKEN> &`{{copy}}
